defaults:
  - .@kwargs.encoder.embedding_kwargs: embedding
  - _self_

type: particle_net
name: particle_net_test
kwargs:
  encoder:
    embedding_kwargs:
      out_dim: 64
      features_to_drop:
        global: "all" # global features are not supported
      hidden_dim: [512, 1024, 512] # adjust to dropped global features
    conv_params: [
      [16, [64, 64, 64]],
      [16, [128, 128, 128]],
      [16, [256, 256, 256]]
    ]
    conv_pooling: 'mean'
    masking: true
    coordinate_type: polar
    spatial_features: ['r', 'theta']
  decoder:
    use_global_features: true
    dense_params: [256, 256]
    dropout_rate: 0.1
    n_outputs: 4
